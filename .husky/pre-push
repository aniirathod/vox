#!/usr/bin/env sh

# Define Colors
PURPLE='\033[1;35m'
RED='\033[1;31m'
GREEN='\033[1;32m'
YELLOW='\033[1;33m'
RESET='\033[0m'

echo "${YELLOW}ðŸš§ Initializing Turbo Engine...${RESET}"

# Run Checks: Types, Tests, AND LINTING
# We use --output-logs=new-only to keep the output clean
CI=true npx turbo run check-types lint --output-logs=new-only

# Capture Exit Code
RESULT=$?

if [ $RESULT -ne 0 ]; then
  echo ""
  echo "${RED}ðŸ’¥ PUSH BLOCKED! ${RESET}"
  echo "${RED}   The fortress gates are closed.${RESET}"
  echo "${YELLOW}   Please fix Lint Errors, Types, or Tests before pushing.${RESET}"
  echo ""
  exit 1
fi

echo ""
echo "${GREEN}âœ… Integrity Verified. Pushing to Remote...${RESET}"
echo "${PURPLE}=========================================${RESET}"
echo ""
exit 0